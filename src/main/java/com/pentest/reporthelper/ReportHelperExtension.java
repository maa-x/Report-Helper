package com.pentest.reporthelper;

import org.fife.ui.rsyntaxtextarea.AbstractTokenMakerFactory;
import org.fife.ui.rsyntaxtextarea.TokenMakerFactory;

import com.pentest.reporthelper.ui.editor.ReportHelperHttpRequestEditorProvider;
import com.pentest.reporthelper.ui.editor.ReportHelperHttpResponseEditorProvider;

import burp.api.montoya.BurpExtension;
import burp.api.montoya.MontoyaApi;

public class ReportHelperExtension implements BurpExtension {

    @Override
    public void initialize(MontoyaApi api)
    {
        AbstractTokenMakerFactory atmf = (AbstractTokenMakerFactory)TokenMakerFactory.getDefaultInstance();
        atmf.putMapping("text/HTTP", "com.pentest.reporthelper.tokenmakers.HTTPTokenMaker");
        atmf.putMapping("application/json", "org.fife.ui.rsyntaxtextarea.modes.JsonTokenMaker");
        atmf.putMapping("application/javascript", "org.fife.ui.rsyntaxtextarea.modes.JavaScriptTokenMaker");

        atmf.putMapping("image/svg+xml", "org.fife.ui.rsyntaxtextarea.modes.XMLTokenMaker");
        api.extension().setName("Report helper view");
        api.userInterface().registerHttpResponseEditorProvider(new ReportHelperHttpResponseEditorProvider(api));
        api.userInterface().registerHttpRequestEditorProvider(new ReportHelperHttpRequestEditorProvider(api));
    }
}
