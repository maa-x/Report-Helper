package com.pentest.reporthelper.ui.action;

import javax.swing.*;
import java.awt.event.ActionEvent;
import org.fife.ui.rtextarea.RTextArea;
import org.fife.ui.rtextarea.RecordableTextAction;
import org.fife.ui.rsyntaxtextarea.RSyntaxTextArea;

abstract class BaseAction extends RecordableTextAction {
    BaseAction(String name) {
        super(name);
    }

    BaseAction(String name, Icon icon, String desc, Integer mnemonic, KeyStroke accelerator) {
        super(name, icon, desc, mnemonic, accelerator);
    }

    @Override
    public void actionPerformedImpl(ActionEvent e, RTextArea textArea) {
        RSyntaxTextArea rsta = (RSyntaxTextArea) textArea;

        String currentText = rsta.getText();
        if (currentText == null
                || currentText.length() == 0
                || rsta.getSelectedText() == null
                || rsta.getSelectedText().length() == 0
                || rsta.getSelectionStart() < 0
                || rsta.getSelectionStart() == rsta.getSelectionEnd()) {
            return;
        }
        String replacementString = getReplacementString();
        String newText = currentText.substring(0, rsta.getSelectionStart()) + replacementString
                + currentText.substring(rsta.getSelectionEnd());
        rsta.setText(newText);
        rsta.revalidate();
    }

    protected abstract String getReplacementString();

    @Override
    public String getMacroID() {
        return "com.pentest.reporthelper.BaseAction";
    }
}
