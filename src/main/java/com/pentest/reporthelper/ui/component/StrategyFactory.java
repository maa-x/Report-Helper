package com.pentest.reporthelper.ui.component;

import java.util.List;

import com.pentest.reporthelper.formatter.strategies.*;

public class StrategyFactory {

    /**
     * Gets the appropriate header formatter strategy.
     *
     * @param includeHeaders Whether headers should be included.
     * @param censorCookies  Whether cookies should be left uncensored.
     * @param headersToRemove List of headers to remove for advanced strategy.
     * @return the strategy.
     */
    public static HttpHeaderFormatterStrategy getStrategy(boolean includeHeaders, boolean censorCookies, List<String> headersToRemove) {
        if (!includeHeaders) {
            return new RemovingStrategy();
        } else if (censorCookies && (headersToRemove == null || headersToRemove.isEmpty())) {
            return new CensoringStrategy();
        } else if (headersToRemove != null && !headersToRemove.isEmpty()) {
            return new AdvancedHeaderStrategy(headersToRemove, censorCookies);
        }
        return new NoOpFormatterStrategy();
    }
}
