package com.pentest.reporthelper.ui.editor;

import java.awt.Component;

import com.pentest.reporthelper.ui.component.ReportHelperComponent;

import burp.api.montoya.MontoyaApi;
import burp.api.montoya.http.message.HttpRequestResponse;
import burp.api.montoya.logging.Logging;
import burp.api.montoya.ui.Selection;
import burp.api.montoya.ui.editor.extension.EditorCreationContext;
import burp.api.montoya.ui.editor.extension.ExtensionProvidedEditor;

public class ReportHelperEditor implements ExtensionProvidedEditor {
    protected HttpRequestResponse requestResponse;
    protected final Logging logging;
    protected ReportHelperComponent uiComponent;
    protected MontoyaApi api;

    ReportHelperEditor(MontoyaApi api, EditorCreationContext creationContext) {
        this.logging = api.logging();
        this.api = api;
    }

    @Override
    public String caption() {
        return "Reporting";
    }

    @Override
    public boolean isModified() {
        // return this.editor.isModified();
        return false;
    }

    @Override
    public Selection selectedData() {
        if (this.uiComponent != null) {
            return this.uiComponent.selectedData();
        }
        return null;
    }

    @Override
    public Component uiComponent() {
        return this.uiComponent;
    }

    @Override
    public boolean isEnabledFor(HttpRequestResponse requestResponse) {
        return requestResponse != null && requestResponse.response() != null && requestResponse.response().toString().length() > 0;
    }

    @Override
    public void setRequestResponse(HttpRequestResponse requestResponse) {
        this.requestResponse = requestResponse;
        uiComponent.setRequestResponse(requestResponse);
    }
}
