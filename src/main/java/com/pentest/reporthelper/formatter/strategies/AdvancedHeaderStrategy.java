package com.pentest.reporthelper.formatter.strategies;

import java.util.List;

import burp.api.montoya.http.message.requests.HttpRequest;
import burp.api.montoya.http.message.responses.HttpResponse;

public class AdvancedHeaderStrategy implements HttpHeaderFormatterStrategy {

    private final List<String> headersToRemove;
    private CensoringStrategy censoringStrategy = null;

    public AdvancedHeaderStrategy(List<String> headersToRemove, boolean censorCookiesorAuthorization) {
        this.headersToRemove = headersToRemove;
        if (censorCookiesorAuthorization) {
            this.censoringStrategy = new CensoringStrategy();
        }
    }

    @Override
    public HttpResponse formatResponse(HttpResponse response) {
        for (String header : headersToRemove) {
            response = response.withRemovedHeader(header);
        }
        if (censoringStrategy != null) {
            response = censoringStrategy.formatResponse(response);
        }
        return response;
    }

    @Override
    public HttpRequest formatRequest(HttpRequest request) {
        for (String header : headersToRemove) {
            request = request.withRemovedHeader(header);
        }
        if (censoringStrategy != null) {
            request = censoringStrategy.formatRequest(request);
        }
        return request;
    }
}