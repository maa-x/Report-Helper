package com.pentest.reporthelper.tokenmakers.util;

import java.util.TreeMap;

public class ContentTypeManager {
    private TreeMap<Integer, String> offsetContentTypeMap;

    public ContentTypeManager() {
        offsetContentTypeMap = new TreeMap<>();
    }

    public void setContentType(int offset, String contentType) {
        offsetContentTypeMap.put(offset, contentType);
    }

    public String getContentType(int offset) {
        Integer key = offsetContentTypeMap.floorKey(offset);
        if (key != null) {
            return offsetContentTypeMap.get(key).split(";")[0];
        }
        return "application/x-www-form-urlencoded";
    }
}
